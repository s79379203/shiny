valueBox(round(suboutput$samt / 6))
valueBox(nkgtotal <- round(sum(suboutput$samt) / 10000))
valueBox(round(nkgtotal / 6))
nkg_all <- subset(sqlResultall,ClientNo=="27580987-1")
View(nkg_all)
valueBox(nkgtotal <- round(sum(nkg_all$samt) / 10000))
valueBox(round(nkgtotal / 6))
save(sqlResultall, file = "C:/Users/elvis/Documents/fwt_reports/fwtdata.RData")
nkg_all
nkg_all <- subset(sqlResultall,ClientNo=="27580987-1")
valueBox(nkgoutput <- round(sum(nkg_all$samt) / 10000))
valueBox(round(nkgoutput / 6))
View(sqlResultall)
require(RODBC)
#20180720測試:連結大帳省ERP資料庫
#除了上面用merge方式取得ERP出貨資料, 亦可直接使用sql語法直接讀取出貨資料
#open the ODBC connection
ch <- odbcConnect("N_ERP",uid="sa",pwd="intron")
#台北的資料庫為Icompany8
sqlResult <- sqlQuery(ch, "SELECT
Pact.actDate AS 'shipdate',
Card.no As 'ClientNo',
Card.name AS 'client',
SubShip.name AS 'partno',
vary.amountUI*ship.moneyDB AS 'samt',
Vary.vol*-1 AS 'sqty',
Vary.cost AS 'Runitprice',
vary.vol*vary.cost*-1 AS 'scost',
Ship.agent AS 'salesno',
Card_1.name AS 'salesman'
FROM ICompany8.dbo.Card Card,                                         ICompany8.dbo.Card Card_1,
ICompany8.dbo.Pact Pact,
ICompany8.dbo.Ship Ship,
ICompany8.dbo.SubShip SubShip,                                        ICompany8.dbo.Vary Vary
WHERE Ship.pact = Pact.pact AND                                       Vary.vary = SubShip.vary AND
Vary.pact = Pact.pact AND
Card.card = Ship.who AND
Ship.agent = Card_1.card
AND ((Card.kind=-1) AND
(Pact.ui=30) AND
(Pact.actDate>={ts '2021-01-01 00:00:00'}
And Pact.actDate<={ts '2021-07-01 00:00:00'}))")
#write.csv(sqlResult, "D:/Bigdata/ERPTP2018d.csv")
#讀取HK資料庫Icompany13
sqlResult13 <- sqlQuery(ch, "SELECT Pact.actDate AS 'shipdate',
Card.no As 'ClientNo',
Card.name AS 'client',
SubShip.name AS 'partno',
vary.amountUI*ship.moneyDB AS 'samt',
Vary.vol*-1 AS 'sqty',
Vary.cost AS 'Runitprice',
vary.vol*vary.cost*-1 AS 'scost',
Ship.agent AS 'salesno',
Card_1.name AS 'salesman'
FROM ICompany13.dbo.Card Card,
ICompany13.dbo.Card Card_1,
ICompany13.dbo.Pact Pact,
ICompany13.dbo.Ship Ship,
ICompany13.dbo.SubShip SubShip,
ICompany13.dbo.Vary Vary
WHERE Ship.pact = Pact.pact AND
Vary.vary = SubShip.vary AND
Vary.pact = Pact.pact AND
Card.card = Ship.who AND
Ship.agent = Card_1.card AND
((Card.kind=-1) AND (Pact.ui=30) AND
(Pact.actDate>={ts '2021-01-01 00:00:00'} And
Pact.actDate<={ts '2021-07-01 00:00:00'}))")
write.csv(sqlResult13, "D:/ElvisData/Bigdata/ERPHK20210701.csv")
sqlResultall <- rbind(sqlResult, sqlResult13)
#Transform ClientNo from factor into character
sqlResultall$ClientNo <- as.character(sqlResultall$ClientNo)
#write.csv(sqlResultall, "D:/ElvisData/Bigdata/ERPTP201401-201806.csv")
#write.csv(sqlResultall, "D:/ElvisData/Bigdata/ERPTP201801-201906.csv")
#write.csv(sqlResultall, "D:/ElvisData/Bigdata/ERPTP201801-201907.csv")
#write.csv(sqlResultall, "D:/ElvisData/Bigdata/ERPTP201901-11.csv")
#write.csv(sqlResultall, "D:/ElvisData/Bigdata/ERPTP2018-202004A.csv")
#close the ODBC connection
#利用Write_xlsx解決客戶編號轉文字檔時, 部份資料格式錯誤
write_xlsx(sqlResultall,"D:/ElvisData/Bigdata/ERPTP2021.xlsx")
odbcClose(ch)
View(nkg_all)
#27580987-1 CAL-COMP
#4370927 金寶電子
#27580987-4 泰金寶光電(岳陽)
nkg_all <- subset(sqlResultall,ClientNo=="27580987-1" |
ClientNo=="4370927" |
ClientNo=="27580987-4")
valueBox(nkgoutput <- round(sum(nkg_all$samt) / 10000))
View(nkg_all)
rmarkdown::render("fwt_dashboards.Rmd")
sum(nkg_all$samt)
View(nkg_all)
View(sqlResultall)
#27580987-1 CAL-COMP
#04370927 金寶電子
#27580987-4 泰金寶光電(岳陽)
nkg_all <- subset(sqlResultall,ClientNo=="27580987-1" |
ClientNo=="04370927" |
ClientNo=="27580987-4")
valueBox(nkgoutput <- round(sum(nkg_all$samt) / 10000))
sum(nkg_all$samt)
View(nkg_all)
sum(nkg_all$samt)
#27580987-1 CAL-COMP
#04370927 金寶電子
#27580987-4 泰金寶光電(岳陽)
#ClientNo=="04370927"
#ClientNo=="27580987-4"|
nkg_all <- subset(sqlResultall,ClientNo=="27580987-1")
valueBox(nkgoutput <- round(sum(nkg_all$samt) / 10000))
#27580987-1 CAL-COMP
#04370927 金寶電子
#27580987-4 泰金寶光電(岳陽)
#ClientNo=="27580987-1
#ClientNo=="04370927"
#ClientNo=="27580987-4"|
nkg_all <- subset(sqlResultall,ClientNo=="04370927")
valueBox(nkgoutput <- round(sum(nkg_all$samt) / 10000))
#27580987-1 CAL-COMP
#04370927 金寶電子
#27580987-4 泰金寶光電(岳陽)
#ClientNo=="27580987-1
#ClientNo=="04370927"
#ClientNo=="27580987-4"|
nkg_all <- subset(sqlResultall,ClientNo=="04370927")
valueBox(nkgoutput <- round(sum(nkg_all$samt) / 10000))
#27580987-1 CAL-COMP
#04370927 金寶電子
#27580987-4 泰金寶光電(岳陽)
#ClientNo=="27580987-1
#ClientNo=="04370927"
#ClientNo=="27580987-4"|
nkg_all <- subset(sqlResultall,ClientNo=="27580987-4")
valueBox(nkgoutput <- round(sum(nkg_all$samt) / 10000))
View(nkg_all)
#27580987-1 CAL-COMP
#04370927 金寶電子
#27580987-4 泰金寶光電(岳陽)
#ClientNo=="27580987-1
#ClientNo=="04370927"
#ClientNo=="27580987-4"|
nkg_all <- subset(sqlResultall,ClientNo=="27580987-4" |
ClientNo=="04370927" |
ClientNo=="27580987-1")
valueBox(nkgoutput <- round(sum(nkg_all$samt) / 10000))
#run the query, store in a data frame
######################
library("writexl")
require(RODBC)
#20180720測試:連結大帳省ERP資料庫
#除了上面用merge方式取得ERP出貨資料, 亦可直接使用sql語法直接讀取出貨資料
#open the ODBC connection
ch <- odbcConnect("N_ERP",uid="sa",pwd="intron")
#台北的資料庫為Icompany8
sqlResult <- sqlQuery(ch, "SELECT
Pact.actDate AS 'shipdate',
Card.no As 'ClientNo',
Card.name AS 'client',
SubShip.name AS 'partno',
vary.amountUI*ship.moneyDB AS 'samt',
Vary.vol*-1 AS 'sqty',
Vary.cost AS 'Runitprice',
vary.vol*vary.cost*-1 AS 'scost',
Ship.agent AS 'salesno',
Card_1.name AS 'salesman'
FROM ICompany8.dbo.Card Card,                                         ICompany8.dbo.Card Card_1,
ICompany8.dbo.Pact Pact,
ICompany8.dbo.Ship Ship,
ICompany8.dbo.SubShip SubShip,                                        ICompany8.dbo.Vary Vary
WHERE Ship.pact = Pact.pact AND                                       Vary.vary = SubShip.vary AND
Vary.pact = Pact.pact AND
Card.card = Ship.who AND
Ship.agent = Card_1.card
AND ((Card.kind=-1) AND
(Pact.ui=30) AND
(Pact.actDate>={ts '2021-07-01 00:00:00'}
And Pact.actDate<={ts '2021-07-13 00:00:00'}))")
#write.csv(sqlResult, "D:/Bigdata/ERPTP2018d.csv")
#讀取HK資料庫Icompany13
sqlResult13 <- sqlQuery(ch, "SELECT Pact.actDate AS 'shipdate',
Card.no As 'ClientNo',
Card.name AS 'client',
SubShip.name AS 'partno',
vary.amountUI*ship.moneyDB AS 'samt',
Vary.vol*-1 AS 'sqty',
Vary.cost AS 'Runitprice',
vary.vol*vary.cost*-1 AS 'scost',
Ship.agent AS 'salesno',
Card_1.name AS 'salesman'
FROM ICompany13.dbo.Card Card,
ICompany13.dbo.Card Card_1,
ICompany13.dbo.Pact Pact,
ICompany13.dbo.Ship Ship,
ICompany13.dbo.SubShip SubShip,
ICompany13.dbo.Vary Vary
WHERE Ship.pact = Pact.pact AND
Vary.vary = SubShip.vary AND
Vary.pact = Pact.pact AND
Card.card = Ship.who AND
Ship.agent = Card_1.card AND
((Card.kind=-1) AND (Pact.ui=30) AND
(Pact.actDate>={ts '2021-07-01 00:00:00'} And
Pact.actDate<={ts '2021-07-13 00:00:00'}))")
write.csv(sqlResult13, "D:/ElvisData/Bigdata/ERPHK20210713.csv")
#sqlResultall <- rbind(sqlResult, sqlResult13)
sqlResultall7 <- rbind(sqlResult, sqlResult13)
#Transform ClientNo from factor into character
sqlResultall$ClientNo <- as.character(sqlResultall$ClientNo)
#write.csv(sqlResultall, "D:/ElvisData/Bigdata/ERPTP201401-201806.csv")
#write.csv(sqlResultall, "D:/ElvisData/Bigdata/ERPTP201801-201906.csv")
#write.csv(sqlResultall, "D:/ElvisData/Bigdata/ERPTP201801-201907.csv")
#write.csv(sqlResultall, "D:/ElvisData/Bigdata/ERPTP201901-11.csv")
#write.csv(sqlResultall, "D:/ElvisData/Bigdata/ERPTP2018-202004A.csv")
#close the ODBC connection
#利用Write_xlsx解決客戶編號轉文字檔時, 部份資料格式錯誤
#write_xlsx(sqlResultall,"D:/ElvisData/Bigdata/ERPTP2021.xlsx")
write_xlsx(sqlResultall7,"D:/ElvisData/Bigdata/ERPTP202107.xlsx")
odbcClose(ch)
#sqlResultall$ShipYY <- year(sqlResultall$shipdate)
#sqlResultall$ShipMM <- month(sqlResultall$shipdate)
#totaloutput <- round(sum(sqlResultall$samt) / 10000 )
totaloutput7 <- round(sum(sqlResultall7$samt) / 10000 )
#nkg_all <- subset(sqlResultall,ClientNo=="27580987-1")
save(sqlResultall, file = "C:/Users/elvis/Documents/fwt_reports/fwtdata.RData")
sqlResultall7
View(sqlResultall7)
valueBox(totaloutput7 <- round(sum(sqlResultall7$samt) / 10000))
View(sqlResultall7)
valueBox(totaloutput7 <- round(sum(sqlResultall7$samt) / 10000))
totaloutput7
rmarkdown::render("fwt_dashboards.Rmd")
load("C:/Users/elvis/Documents/fwt_reports/fwtdata.RData")
save(sqlResultall, file = "C:/Users/elvis/Documents/fwt_reports/fwtdata.RData")
load("C:/Users/elvis/Documents/fwt_reports/fwtdata.RData")
valueBox(nkgoutput7 <- round(sum(sqlResultall7$samt) / 10000))
valueBox(nkgoutput7)
View(sqlResultall7)
nkgoutput7 <- round(sum(sqlResultall7$samt) / 10000)
valueBox(nkgoutput7)
View(sqlResultall7)
View(nkg_allB)
######################
library("writexl")
require(RODBC)
#20180720測試:連結大帳省ERP資料庫
#除了上面用merge方式取得ERP出貨資料, 亦可直接使用sql語法直接讀取出貨資料
#open the ODBC connection
ch <- odbcConnect("N_ERP",uid="sa",pwd="intron")
#台北的資料庫為Icompany8
sqlResult <- sqlQuery(ch, "SELECT
Pact.actDate AS 'shipdate',
Card.no As 'ClientNo',
Card.name AS 'client',
SubShip.name AS 'partno',
vary.amountUI*ship.moneyDB AS 'samt',
Vary.vol*-1 AS 'sqty',
Vary.cost AS 'Runitprice',
vary.vol*vary.cost*-1 AS 'scost',
Ship.agent AS 'salesno',
Card_1.name AS 'salesman'
FROM ICompany8.dbo.Card Card,                                         ICompany8.dbo.Card Card_1,
ICompany8.dbo.Pact Pact,
ICompany8.dbo.Ship Ship,
ICompany8.dbo.SubShip SubShip,                                        ICompany8.dbo.Vary Vary
WHERE Ship.pact = Pact.pact AND                                       Vary.vary = SubShip.vary AND
Vary.pact = Pact.pact AND
Card.card = Ship.who AND
Ship.agent = Card_1.card
AND ((Card.kind=-1) AND
(Pact.ui=30) AND
(Pact.actDate>={ts '2021-07-01 00:00:00'}
And Pact.actDate<={ts '2021-07-13 00:00:00'}))")
#write.csv(sqlResult, "D:/Bigdata/ERPTP2018d.csv")
#讀取HK資料庫Icompany13
sqlResult13 <- sqlQuery(ch, "SELECT Pact.actDate AS 'shipdate',
Card.no As 'ClientNo',
Card.name AS 'client',
SubShip.name AS 'partno',
vary.amountUI*ship.moneyDB AS 'samt',
Vary.vol*-1 AS 'sqty',
Vary.cost AS 'Runitprice',
vary.vol*vary.cost*-1 AS 'scost',
Ship.agent AS 'salesno',
Card_1.name AS 'salesman'
FROM ICompany13.dbo.Card Card,
ICompany13.dbo.Card Card_1,
ICompany13.dbo.Pact Pact,
ICompany13.dbo.Ship Ship,
ICompany13.dbo.SubShip SubShip,
ICompany13.dbo.Vary Vary
WHERE Ship.pact = Pact.pact AND
Vary.vary = SubShip.vary AND
Vary.pact = Pact.pact AND
Card.card = Ship.who AND
Ship.agent = Card_1.card AND
((Card.kind=-1) AND (Pact.ui=30) AND
(Pact.actDate>={ts '2021-07-01 00:00:00'} And
Pact.actDate<={ts '2021-07-13 00:00:00'}))")
write.csv(sqlResult13, "D:/ElvisData/Bigdata/ERPHK20210713.csv")
#sqlResultall <- rbind(sqlResult, sqlResult13)
sqlResultallE <- rbind(sqlResult, sqlResult13)
#Transform ClientNo from factor into character
sqlResultall$ClientNo <- as.character(sqlResultall$ClientNo)
#write.csv(sqlResultall, "D:/ElvisData/Bigdata/ERPTP201401-201806.csv")
#write.csv(sqlResultall, "D:/ElvisData/Bigdata/ERPTP201801-201906.csv")
#write.csv(sqlResultall, "D:/ElvisData/Bigdata/ERPTP201801-201907.csv")
#write.csv(sqlResultall, "D:/ElvisData/Bigdata/ERPTP201901-11.csv")
#write.csv(sqlResultall, "D:/ElvisData/Bigdata/ERPTP2018-202004A.csv")
#close the ODBC connection
#利用Write_xlsx解決客戶編號轉文字檔時, 部份資料格式錯誤
#write_xlsx(sqlResultall,"D:/ElvisData/Bigdata/ERPTP2021.xlsx")
write_xlsx(sqlResultall7,"D:/ElvisData/Bigdata/ERPTP202107.xlsx")
odbcClose(ch)
valueBox(totaloutputE <- round(sum(sqlResultallE$samt) / 10000))
data <- read.csv("C:/Users/elvis/Documents/fwt_reports/BankChurners.csv")
Categorical.Variables = c("Gender", "Education_Level", "Marital_Status")
Numeric.Variables = c("Customer_Age", "Total_Trans_Ct", "Credit_Limit")
load("C:/Users/elvis/Documents/fwt_reports/fwtdata.RData")
```{r data}
#data <- read.csv("C:/Users/elvis/Documents/fwt_reports/BankChurners.csv")
#Categorical.Variables = c("Gender", "Education_Level", "Marital_Status")
#Numeric.Variables = c("Customer_Age", "Total_Trans_Ct", "Credit_Limit")
load("C:/Users/elvis/Documents/fwt_reports/fwtdata.RData")
```
######################
library("writexl")
require(RODBC)
#20180720測試:連結大帳省ERP資料庫
#除了上面用merge方式取得ERP出貨資料, 亦可直接使用sql語法直接讀取出貨資料
#open the ODBC connection
ch <- odbcConnect("N_ERP",uid="sa",pwd="intron")
#台北的資料庫為Icompany8
sqlResult <- sqlQuery(ch, "SELECT
Pact.actDate AS 'shipdate',
Card.no As 'ClientNo',
Card.name AS 'client',
SubShip.name AS 'partno',
vary.amountUI*ship.moneyDB AS 'samt',
Vary.vol*-1 AS 'sqty',
Vary.cost AS 'Runitprice',
vary.vol*vary.cost*-1 AS 'scost',
Ship.agent AS 'salesno',
Card_1.name AS 'salesman'
FROM ICompany8.dbo.Card Card,                                         ICompany8.dbo.Card Card_1,
ICompany8.dbo.Pact Pact,
ICompany8.dbo.Ship Ship,
ICompany8.dbo.SubShip SubShip,                                        ICompany8.dbo.Vary Vary
WHERE Ship.pact = Pact.pact AND                                       Vary.vary = SubShip.vary AND
Vary.pact = Pact.pact AND
Card.card = Ship.who AND
Ship.agent = Card_1.card
AND ((Card.kind=-1) AND
(Pact.ui=30) AND
(Pact.actDate>={ts '2021-07-01 00:00:00'}
And Pact.actDate<={ts '2021-07-13 00:00:00'}))")
#write.csv(sqlResult, "D:/Bigdata/ERPTP2018d.csv")
#讀取HK資料庫Icompany13
sqlResult13 <- sqlQuery(ch, "SELECT Pact.actDate AS 'shipdate',
Card.no As 'ClientNo',
Card.name AS 'client',
SubShip.name AS 'partno',
vary.amountUI*ship.moneyDB AS 'samt',
Vary.vol*-1 AS 'sqty',
Vary.cost AS 'Runitprice',
vary.vol*vary.cost*-1 AS 'scost',
Ship.agent AS 'salesno',
Card_1.name AS 'salesman'
FROM ICompany13.dbo.Card Card,
ICompany13.dbo.Card Card_1,
ICompany13.dbo.Pact Pact,
ICompany13.dbo.Ship Ship,
ICompany13.dbo.SubShip SubShip,
ICompany13.dbo.Vary Vary
WHERE Ship.pact = Pact.pact AND
Vary.vary = SubShip.vary AND
Vary.pact = Pact.pact AND
Card.card = Ship.who AND
Ship.agent = Card_1.card AND
((Card.kind=-1) AND (Pact.ui=30) AND
(Pact.actDate>={ts '2021-07-01 00:00:00'} And
Pact.actDate<={ts '2021-07-13 00:00:00'}))")
write.csv(sqlResult13, "D:/ElvisData/Bigdata/ERPHK20210713.csv")
#sqlResultall <- rbind(sqlResult, sqlResult13)
sqlResultallE <- rbind(sqlResult, sqlResult13)
#Transform ClientNo from factor into character
sqlResultall$ClientNo <- as.character(sqlResultall$ClientNo)
#write.csv(sqlResultall, "D:/ElvisData/Bigdata/ERPTP201401-201806.csv")
#write.csv(sqlResultall, "D:/ElvisData/Bigdata/ERPTP201801-201906.csv")
#write.csv(sqlResultall, "D:/ElvisData/Bigdata/ERPTP201801-201907.csv")
#write.csv(sqlResultall, "D:/ElvisData/Bigdata/ERPTP201901-11.csv")
#write.csv(sqlResultall, "D:/ElvisData/Bigdata/ERPTP2018-202004A.csv")
#close the ODBC connection
#利用Write_xlsx解決客戶編號轉文字檔時, 部份資料格式錯誤
#write_xlsx(sqlResultall,"D:/ElvisData/Bigdata/ERPTP2021.xlsx")
write_xlsx(sqlResultall7,"D:/ElvisData/Bigdata/ERPTP202107.xlsx")
odbcClose(ch)
#sqlResultall$ShipYY <- year(sqlResultall$shipdate)
#sqlResultall$ShipMM <- month(sqlResultall$shipdate)
#totaloutput <- round(sum(sqlResultall$samt) / 10000 )
totaloutput7 <- round(sum(sqlResultall7$samt) / 10000 )
#nkg_all <- subset(sqlResultall,ClientNo=="27580987-1")
#sqlResultall$ShipYYMM <- substr(sqlResultall$ShipDate, start=1, stop=7) ## Year and Month
# Saving on object in RData format
# C:/Users/elvis/Documents/fwt_reports
save(sqlResultall, file = "C:/Users/elvis/Documents/fwt_reports/fwtdata.RData")
# Save multiple objects
#save(data1, data2, file = "data.RData")
save(sqlResultall,sqlResultall7,  file = "C:/Users/elvis/Documents/fwt_reports/fwtdata.RData")
# To load the data again
#load("C:/Users/elvis/Documents/fwt_reports/fwtdata.RData")
######################
#run the query, store in a data frame
######################
library("writexl")
require(RODBC)
#20180720測試:連結大帳省ERP資料庫
#除了上面用merge方式取得ERP出貨資料, 亦可直接使用sql語法直接讀取出貨資料
#open the ODBC connection
ch <- odbcConnect("N_ERP",uid="sa",pwd="intron")
#台北的資料庫為Icompany8
sqlResult <- sqlQuery(ch, "SELECT
Pact.actDate AS 'shipdate',
Card.no As 'ClientNo',
Card.name AS 'client',
SubShip.name AS 'partno',
vary.amountUI*ship.moneyDB AS 'samt',
Vary.vol*-1 AS 'sqty',
Vary.cost AS 'Runitprice',
vary.vol*vary.cost*-1 AS 'scost',
Ship.agent AS 'salesno',
Card_1.name AS 'salesman'
FROM ICompany8.dbo.Card Card,                                         ICompany8.dbo.Card Card_1,
ICompany8.dbo.Pact Pact,
ICompany8.dbo.Ship Ship,
ICompany8.dbo.SubShip SubShip,                                        ICompany8.dbo.Vary Vary
WHERE Ship.pact = Pact.pact AND                                       Vary.vary = SubShip.vary AND
Vary.pact = Pact.pact AND
Card.card = Ship.who AND
Ship.agent = Card_1.card
AND ((Card.kind=-1) AND
(Pact.ui=30) AND
(Pact.actDate>={ts '2021-01-01 00:00:00'}
And Pact.actDate<={ts '2021-07-13 00:00:00'}))")
#write.csv(sqlResult, "D:/Bigdata/ERPTP2018d.csv")
#讀取HK資料庫Icompany13
sqlResult13 <- sqlQuery(ch, "SELECT Pact.actDate AS 'shipdate',
Card.no As 'ClientNo',
Card.name AS 'client',
SubShip.name AS 'partno',
vary.amountUI*ship.moneyDB AS 'samt',
Vary.vol*-1 AS 'sqty',
Vary.cost AS 'Runitprice',
vary.vol*vary.cost*-1 AS 'scost',
Ship.agent AS 'salesno',
Card_1.name AS 'salesman'
FROM ICompany13.dbo.Card Card,
ICompany13.dbo.Card Card_1,
ICompany13.dbo.Pact Pact,
ICompany13.dbo.Ship Ship,
ICompany13.dbo.SubShip SubShip,
ICompany13.dbo.Vary Vary
WHERE Ship.pact = Pact.pact AND
Vary.vary = SubShip.vary AND
Vary.pact = Pact.pact AND
Card.card = Ship.who AND
Ship.agent = Card_1.card AND
((Card.kind=-1) AND (Pact.ui=30) AND
(Pact.actDate>={ts '2021-01-01 00:00:00'} And
Pact.actDate<={ts '2021-07-13 00:00:00'}))")
write.csv(sqlResult13, "D:/ElvisData/Bigdata/ERPHK20210713.csv")
sqlResultall <- rbind(sqlResult, sqlResult13)
#sqlResultall7 <- subset(sqlResultall, sqlResultall$)
#Transform ClientNo from factor into character
sqlResultall$ClientNo <- as.character(sqlResultall$ClientNo)
#write.csv(sqlResultall, "D:/ElvisData/Bigdata/ERPTP201401-201806.csv")
#write.csv(sqlResultall, "D:/ElvisData/Bigdata/ERPTP201801-201906.csv")
#write.csv(sqlResultall, "D:/ElvisData/Bigdata/ERPTP201801-201907.csv")
#write.csv(sqlResultall, "D:/ElvisData/Bigdata/ERPTP201901-11.csv")
#write.csv(sqlResultall, "D:/ElvisData/Bigdata/ERPTP2018-202004A.csv")
#close the ODBC connection
#利用Write_xlsx解決客戶編號轉文字檔時, 部份資料格式錯誤
#write_xlsx(sqlResultall,"D:/ElvisData/Bigdata/ERPTP2021.xlsx")
write_xlsx(sqlResultall7,"D:/ElvisData/Bigdata/ERPTP202107.xlsx")
odbcClose(ch)
View(sqlResult)
View(sqlResultall)
sqlResultall7 <- subset(sqlResultall, sqlResult$shipdate >={ts '2021-07-01 00:00:00'} )
sqlResultall7 <- subset(sqlResultall, sqlResult$shipdate >='2021-07-01 00:00:00')
View(sqlResultall7)
save(sqlResultall,sqlResultall7,  file = "C:/Users/elvis/Documents/fwt_reports/fwtdata.RData")
```{r data}
#data <- read.csv("C:/Users/elvis/Documents/fwt_reports/BankChurners.csv")
#Categorical.Variables = c("Gender", "Education_Level", "Marital_Status")
#Numeric.Variables = c("Customer_Age", "Total_Trans_Ct", "Credit_Limit")
load("C:/Users/elvis/Documents/fwt_reports/fwtdata.RData")
```
View(sqlResultall7)
View(sqlResultall7)
View(sqlResultall)
View(sqlResultall7)
sqlResultall7 <- subset(sqlResultall, sqlResultall$shipdate >='2021-07-01 00:00:00')
View(sqlResultall7)
save(sqlResultall,sqlResultall7,  file = "C:/Users/elvis/Documents/fwt_reports/fwtdata.RData")
```{r data}
#data <- read.csv("C:/Users/elvis/Documents/fwt_reports/BankChurners.csv")
#Categorical.Variables = c("Gender", "Education_Level", "Marital_Status")
#Numeric.Variables = c("Customer_Age", "Total_Trans_Ct", "Credit_Limit")
load("C:/Users/elvis/Documents/fwt_reports/fwtdata.RData")
```
View(sqlResultall7)
rmarkdown::render("fwt_dashboards.Rmd")
